package jxpacket.benchmark;

import io.netty.buffer.ByteBuf;
import io.netty.buffer.ByteBufAllocator;
import io.netty.buffer.PooledByteBufAllocator;
import io.netty.util.ResourceLeakDetector;
import io.netty.util.internal.StringUtil;
import jxpacket.ethernet.Ethernet;
import org.openjdk.jmh.annotations.Benchmark;
import org.openjdk.jmh.annotations.BenchmarkMode;
import org.openjdk.jmh.annotations.Mode;
import org.pcap4j.packet.EthernetPacket;
import org.pcap4j.packet.IllegalRawDataException;

public class PacketFactory {


	protected static final String ETHERNET_II_IEEE_802_1ad_802_1Q_IPV4 =
			"00000000000000109400001588a8001e810020650800450005c254b00000fffdddbdc0550117c055010f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004fdccd64218db64ea845f880dd1739726263f12ece8e831b";

	protected static final String ETHERNET_II_Q_IN_Q_ARP = "ffffffffffffca030db4001c81000064810000c808060001080006040001ca030db4001cc0a802c8000000000000c0a802fe0000000000000000000000000000";

	protected static final String NEIGHBOR_SOLICITATION = "3333fff50000c20054f5000086dd6e00000000183aff00000000000000000000000000000000ff0200000000000000000001fff500008700673c00000000fe80000000000000c00054fffef50000";
	protected static final String NEIGHBOR_ADVERTISEMENT = "333300000001c20054f5000086dd6e00000000203afffe80000000000000c00054fffef50000ff02000000000000000000000000000188009abba0000000fe80000000000000c00054fffef500000201c20054f50000";
	protected static final String ROUTER_ADVERTISEMENT = "333300000001c20054f5000086dd6e00000000403afffe80000000000000c00054fffef50000ff0200000000000000000000000000018600c4fe4000070800000000000000000101c20054f5000005010000000005dc030440c000278d0000093a800000000020010db8000000010000000000000000";
	protected static final String MULTICST_LISTENER_REPORT_MESSAGE_V2 = "333300000016c20054f5000086dd6e00000000240001fe80000000000000c00054fffef50000ff0200000000000000000000000000163a000502000001008f005c130000000104000000ff020000000000000000000000000002";
	protected static final String MULTICST_LISTENER_REPORT = "3333ff0e4c67000c290e4c6786dd600000000020000100000000000000000000000000000000ff0200000000000000000001ff0e4c673a000502000001008300e7b800000000ff0200000000000000000001ff0e4c67";

	protected static final String IPV6_AH = "333300000005c20168b3000186dd6e00000000403301fe800000000000000000000000000002ff02000000000000000000000000000559040000000001000000002035482148b2435a23dcdd5536030100280202020200000001f17300000000000501000013000a0028020202020101010101010101";

	protected static final String IPV6_ROUTING = "0013c4c784f000123fae22f786dd6000000000202b04220000000000024402123ffffeae22f7220000000000024000020000000000043a02000100000000220000000000021000020000000000048000d3ab00000000";


	@Benchmark
	@BenchmarkMode(Mode.AverageTime)
	public void jxpacket() {
		ResourceLeakDetector.setLevel(ResourceLeakDetector.Level.ADVANCED);
		ByteBufAllocator allocator = PooledByteBufAllocator.DEFAULT;
		byte[] data = StringUtil.decodeHexDump(ETHERNET_II_IEEE_802_1ad_802_1Q_IPV4);
		ByteBuf buf = allocator.directBuffer(data.length);
		buf.setBytes(0, data);
		Ethernet ethernet = Ethernet.newPacket(buf);
		buf.clear();
		assert buf.release() == true;
	}

	@Benchmark
	@BenchmarkMode(Mode.AverageTime)
	public void pcap4j() throws IllegalRawDataException {
		byte[] data = StringUtil.decodeHexDump(ETHERNET_II_IEEE_802_1ad_802_1Q_IPV4);
		EthernetPacket ethernetPacket = EthernetPacket.newPacket(data, 0, data.length);
	}

}
